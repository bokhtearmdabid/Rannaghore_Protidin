{% extends "base.html" %}
{% load static %}

{% block title %}{{ p.name }} - Product Details{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/style_product_details.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
{% endblock %}

{% block content %}
<div class="product-details-container">
    <!-- Breadcrumb -->
    <nav class="breadcrumb">
        <a href="{% url 'home' %}">Home</a>
        <i class="fa-solid fa-chevron-right"></i>
        <a href="#">Products</a>
        <i class="fa-solid fa-chevron-right"></i>
        <span>{{ p.name }}</span>
    </nav>

    <!-- Main Product Section -->
    <div class="product-main">
        <!-- Left: Image Gallery -->
        <div class="product-gallery">
            <div class="gallery-main">
                <img src="{{ p.image.url }}" alt="{{ p.name }}" class="main-product-image" id="mainImage">
                <span class="discount-badge"> Upto 40% off </span>
            </div>
            <div class="gallery-thumbnails">
                <div class="thumbnail active">
                    <img src="{{ p.image.url }}" alt="{{ p.name }}">
                </div>
                <div class="thumbnail video-thumb">
                    <i class="fa-solid fa-play"></i>
                    <span>Video</span>
                </div>
                <div class="thumbnail add-more">
                    <i class="fa-solid fa-plus"></i>
                </div>
            </div>
        </div>

        <!-- Right: Product Information -->
        <div class="product-details">
            <!-- Product Header -->
            <div class="product-header">
                <div class="brand-badge">{{ p.brand }}</div>
                <h1 class="product-title">{{ p.name }}</h1>
                <div class="product-rating">
                    <div class="stars">
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star"></i>
                        <i class="fa-solid fa-star-half-stroke"></i>
                    </div>
                    <span class="rating-text">4.5 (128 reviews)</span>
                </div>
            </div>

            <!-- Price Section -->
            <div class="price-box">
                <div class="price-main">
                    <span class="current-price">৳{{ p.price }}</span>
                    <span class="original-price">৳31.00</span>
                </div>
                <div class="price-tag">
                    <span class="save-amount">Save ৳{{ 31|add:"-"|add:p.price }}</span>
                </div>
            </div>

            <!-- Product Description -->
            <div class="product-brief">
                <p>{{ p.brief_description }}</p>
            </div>

            <!-- Size Selection -->
            <div class="option-group">
                <label class="option-label">Size</label>
                <div class="size-options">
                    <button class="size-btn">S</button>
                    <button class="size-btn active">M</button>
                    <button class="size-btn">L</button>
                    <button class="size-btn">XL</button>
                </div>
            </div>

            <!-- Quantity Selection -->
            <div class="option-group">
                <label class="option-label">Quantity</label>
                <div class="quantity-selector">
                    <button class="qty-btn minus"><i class="fa-solid fa-minus"></i></button>
                    <input type="number" class="qty-input" value="1" min="1" max="99">
                    <button class="qty-btn plus"><i class="fa-solid fa-plus"></i></button>
                </div>
            </div>

            <div class="action-buttons">
                <button class="btn-primary add-cart" onclick="window.location.href='{% url 'add_to_cart' p.p_id %}' ">
                    <i class="fa-solid fa-cart-shopping"></i>
                    Add to Cart
                </button>
                <button class="btn-secondary buy-now" onclick="window.location.href='{% url 'buy_now' p.p_id %}'">
                    <i class="fa-solid fa-bolt"></i>
                    Buy Now
                </button>
                <button class="btn-icon wishlist">
                    <i class="fa-regular fa-heart"></i>
                </button>
            </div>
            <!-- Product Meta Info -->
            <div class="product-meta">
                <div class="meta-row">
                    <i class="fa-solid fa-box"></i>
                    <span><strong>SKU:</strong> {{ p.sku }}</span>
                </div>
                <div class="meta-row">
                    <i class="fa-solid fa-truck-fast"></i>
                    <span><strong>Delivery:</strong> 1-3 business days</span>
                </div>
                <div class="meta-row">
                    <i class="fa-solid fa-shield-halved"></i>
                    <span><strong>Warranty:</strong> 30-day return policy</span>
                </div>
            </div>

            <!-- Share Section -->
            <div class="share-section">
                <span class="share-label">Share:</span>
                <div class="share-buttons">
                    <button class="share-btn facebook"><i class="fa-brands fa-facebook-f"></i></button>
                    <button class="share-btn twitter"><i class="fa-brands fa-twitter"></i></button>
                    <button class="share-btn pinterest"><i class="fa-brands fa-pinterest-p"></i></button>
                    <button class="share-btn whatsapp"><i class="fa-brands fa-whatsapp"></i></button>
                </div>
            </div>
        </div>
    </div>

    <!-- Tabs Section -->
    <div class="product-tabs">
        <div class="tabs-header">
            <button class="tab-button active" data-tab="delivery">Delivery Info</button>
            <button class="tab-button" data-tab="reviews">Reviews</button>
            <button class="tab-button" data-tab="payment">Payment</button>
        </div>

        <div class="tabs-content">
            <!-- Delivery Tab -->
            <div class="tab-panel active" id="delivery-tab">
                <div class="info-card">
                    <div class="info-header">
                        <i class="fa-solid fa-truck"></i>
                        <h3>Delivery Information</h3>
                    </div>
                    <p class="info-description">Free standard shipping on orders over ৳1000 before tax, plus free returns.</p>
                    <div class="delivery-table">
                        <div class="delivery-row header">
                            <div>Delivery Area</div>
                            <div>Delivery Time</div>
                            <div>Shipping Cost</div>
                        </div>
                        <div class="delivery-row">
                            <div><i class="fa-solid fa-location-dot"></i> Inside Dhaka</div>
                            <div>1-2 business days</div>
                            <div class="price">৳60</div>
                        </div>
                        <div class="delivery-row">
                            <div><i class="fa-solid fa-location-dot"></i> Outside Dhaka</div>
                            <div>2-3 business days</div>
                            <div class="price">৳120</div>
                        </div>
                    </div>
                </div>

                <div class="info-card return-policy">
                    <div class="info-header">
                        <i class="fa-solid fa-rotate-left"></i>
                        <h3>Return Policy</h3>
                    </div>
                    <p>Please check carefully when you're receiving the parcel. We offer a 30-day return policy for unused items in original packaging.</p>
                </div>
            </div>

            <!-- Reviews Tab -->
            <div class="tab-panel" id="reviews-tab">
                <div class="info-card">
                    <div class="info-header">
                        <i class="fa-solid fa-star"></i>
                        <h3>Customer Reviews</h3>
                    </div>
                    <p class="info-description">Reviews and ratings from our customers.</p>
                    <div class="reviews-placeholder">
                        <i class="fa-regular fa-comment-dots"></i>
                        <p>No reviews yet. Be the first to review this product!</p>
                        <button class="btn-primary">Write a Review</button>
                    </div>
                </div>
            </div>

            <!-- Payment Tab -->
            <div class="tab-panel" id="payment-tab">
                <div class="info-card">
                    <div class="info-header">
                        <i class="fa-solid fa-credit-card"></i>
                        <h3>Payment Methods</h3>
                    </div>
                    <p class="info-description">We accept multiple payment methods for your convenience.</p>
                    <div class="payment-methods">
                        <div class="payment-card">
                            <img src="{% static 'media/products_img/Visa_Logo.png' %}" alt="Visa">
                            <span>Visa</span>
                        </div>
                        <div class="payment-card">
                            <img src="{% static 'media/products_img/BKash_Logo.png' %}" alt="BKash">
                            <span>BKash</span>
                        </div>
                        <div class="payment-card">
                            <img src="{% static 'media/products_img/Nagad_Logo.png' %}" alt="Nagad">
                            <span>Nagad</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Tab switching functionality
    const tabButtons = document.querySelectorAll('.tab-button');
    const tabPanels = document.querySelectorAll('.tab-panel');

    tabButtons.forEach(button => {
        button.addEventListener('click', () => {
            const tabName = button.getAttribute('data-tab');

            tabButtons.forEach(btn => btn.classList.remove('active'));
            tabPanels.forEach(panel => panel.classList.remove('active'));

            button.classList.add('active');
            document.getElementById(`${tabName}-tab`).classList.add('active');
        });
    });

    // Quantity selector
    const qtyInput = document.querySelector('.qty-input');
    const minusBtn = document.querySelector('.qty-btn.minus');
    const plusBtn = document.querySelector('.qty-btn.plus');

    minusBtn.addEventListener('click', () => {
        if (qtyInput.value > 1) {
            qtyInput.value = parseInt(qtyInput.value) - 1;
        }
    });

    plusBtn.addEventListener('click', () => {
        if (qtyInput.value < 99) {
            qtyInput.value = parseInt(qtyInput.value) + 1;
        }
    });

    // Size selection
    const sizeButtons = document.querySelectorAll('.size-btn');
    sizeButtons.forEach(btn => {
        btn.addEventListener('click', () => {
            sizeButtons.forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
        });
    });

    // Wishlist toggle
    const wishlistBtn = document.querySelector('.wishlist');
    wishlistBtn.addEventListener('click', () => {
        const icon = wishlistBtn.querySelector('i');
        icon.classList.toggle('fa-regular');
        icon.classList.toggle('fa-solid');
        wishlistBtn.classList.toggle('active');
    });
</script>
{% endblock %}